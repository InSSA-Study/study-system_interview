# 2장 정리

### 개략적인 규모 추정(시스템 용량, 성능 요구사항)

성능 수치상에서의 사고실험 → 추정치 계산 → 설계가 요구사항에 부합할 것인지 확인

이걸 효과적으로 잘 해낼려면??

- 2의 제곱수
- 응답지연 값
- 가용성에 관계된 수치들

### 2의 제곱수

![Untitled](2%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%203fb7f4af729d46c58dee1a130bb49d86/Untitled.png)

### 응답지연 값

![Untitled](2%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%203fb7f4af729d46c58dee1a130bb49d86/Untitled%201.png)

![Untitled](2%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%203fb7f4af729d46c58dee1a130bb49d86/Untitled%202.png)

![Untitled](2%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%203fb7f4af729d46c58dee1a130bb49d86/Untitled%203.png)

- 메모리는 빠름. 디스크는 여전히 느림
- 가능하면 디스크 탐색 피해라
- 단순한 **압축 알고리즘**은 빠름
    - 파일이나 이미지 **데이터** 등을 **압축하기 위한 논리법**
- 데이터를 인터넷으로 보내기 전에 가능하면 압축해라
- 데이터 센터는 보통 분산되어있고, 데이터를 주고받는데 시간 걸림

### 가용성에 관계된 수치들

- 고가용성: 100%이면 시스템이 단 한 번도 중단된 적이 없었다는 뜻
- SLA(Service Level Agreement): 서비스 사업자와 고객 사이에 맺어진 합의. 9가 많으면 좋음

![Untitled](2%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%85%E1%85%B5%203fb7f4af729d46c58dee1a130bb49d86/Untitled%204.png)

### 예제: 트위터 QPS와 저장소 요구량 추정

1. 일일 활동 사용자(DAU) = 월간 능동 사용자(MAU)  * 50%(트위터를 매일 사용하는 비율)
    - DAU = 3억 * 50% = 1.5억
2. 일일 트윗 수 = DAU * 2 = 1.5억 * 2 = 3억
3. QPS = 일일 트윗 수 / 24시간 / 60분 / 60초 = 약 3500
4. 최대QPS = 2 * QPS = 7000
5. 미디어가 포함된 일일 트윗 수 = 3억 * 10% = 3000만
6. 일일 미디어 저장 요구량 = 3000만 * 1MB = 30TB
7. 5년간 미디어를 보관하기 위한 저장소 요구량: 30TB * 400(365) * 5 = 약 6만TB = 60PB

팁

- 근사치 활용: 99,987 / 9.1 → 100,000 / 10 = 10,000
- 가정들 적어놓기
- 단위 붙이기
- QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등 계산하는 연습 미리하기

연습

200백만 명의 월간 활성 사용자가 있는 소셜 미디어 플랫폼이 있다고 가정해봅시다. 이 중 70%의 사용자가 매일 로그인하며, 각 사용자는 하루에 평균 3개의 게시물을 작성합니다. 이 중 약 20%의 게시물에는 이미지가 포함되며, 각 이미지의 크기는 약 2MB입니다. 모든 데이터는 3년간 저장됩니다.

- **QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수**
    
    서버 개발자는 QPS(Queries Per Second), DAU(Daily Active Users) 및 피크 QPS(Peak Queries Per Second)와 같은 메트릭에 익숙해야 합니다. 이러한 메트릭은 서버 시스템의 성능 및 확장성 요구 사항에 대한 귀중한 통찰력을 제공하기 때문입니다. 이러한 각 측정항목이 중요한 이유는 다음과 같습니다.
    
    1. `QPS(초당 쿼리 수)`: **QPS는 서버 시스템이 1초 내에 받는 쿼리 또는 요청 수를 측정**합니다. 서버 개발자가 서버의 로드를 이해하고 들어오는 요청을 처리할 수 있는 용량을 평가하는 데 도움이 됩니다. 개발자는 QPS를 모니터링하여 서버가 예상되는 트래픽 볼륨을 처리할 수 있는지 여부와 원활한 작동을 위해 최적화 또는 추가 리소스가 필요한지 여부를 결정할 수 있습니다.
    2. `DAU(Daily Active Users)`: DAU는 매일 서버 시스템과 상호 작용하는 순 사용자 수를 나타냅니다. 서버 개발자는 사용자 기반 및 잠재적인 동시 연결에 대한 추정치를 제공하므로 DAU를 고려해야 합니다. ***용량 계획, 리소스 할당 및 예상 사용자 수를 수용하기 위한 서버 인프라 확장에 도움***이 됩니다. DAU를 알면 **개발자는 최대 사용 기간 동안 서버가 예상되는 부하를 처리**할 수 있는지 확인할 수 있습니다.
    3. `피크 QPS(Peak Queries Per Second)`: 피크 QPS는 ***서버 시스템이 가장 바쁜 기간 동안 1초 이내에 받는 쿼리 또는 요청의 최대 수***를 나타냅니다. 서버 개발자가 최대 QPS를 식별하여 *서버가 처리해야 하는 최대 로드를 결정하는 것이 중요*합니다. 피크 QPS를 이해함으로써 개발자는 서버 아키텍처를 설계 및 최적화하고, 캐싱 전략을 구현하고, 인프라를 확장하여 성능 저하 없이 트래픽이 많은 기간의 요구 사항을 충족할 수 있습니다.